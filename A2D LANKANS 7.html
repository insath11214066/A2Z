<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A2Z Lankans - Complete Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1e3c72;
            --secondary-color: #2a5298;
            --accent-color: #ff6b6b;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --gray-color: #7f8c8d;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            position: relative;
        }
        
        #canvas-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        /* Header Styles */
        .header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .logo-3d {
            font-size: 48px;
            font-weight: bold;
            color: var(--accent-color);
            text-shadow: 0 2px 0 #ccc, 0 3px 0 #c9c9c9, 0 4px 0 #bbb, 0 5px 0 #b9b9b9, 0 6px 0 #aaa, 
                         0 7px 1px rgba(0,0,0,.1), 0 0 5px rgba(0,0,0,.1), 0 1px 3px rgba(0,0,0,.3), 
                         0 3px 5px rgba(0,0,0,.2), 0 10px 15px rgba(0,0,0,.25);
            transform: perspective(500px) rotateX(10deg);
            margin-right: 15px;
        }
        
        .logo-text {
            font-size: 32px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4);
            letter-spacing: 2px;
        }
        
        .contact-info {
            margin-top: 15px;
            font-size: 16px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        
        .contact-info p {
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .logout-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Tab Navigation */
        .tabs {
            display: flex;
            background: var(--dark-color);
            overflow-x: auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        
        .tab {
            padding: 18px 30px;
            background: #34495e;
            color: white;
            cursor: pointer;
            border: none;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            white-space: nowrap;
            position: relative;
            overflow: hidden;
        }
        
        .tab:hover {
            background: var(--primary-color);
        }
        
        .tab.active {
            background: var(--primary-color);
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--accent-color);
        }
        
        .tab i {
            font-size: 18px;
        }
        
        /* Content Areas */
        .content-area {
            display: none;
            padding: 25px;
            min-height: 600px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .content-area.active {
            display: block;
        }
        
        /* Stock Management Styles */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            border-left: 5px solid var(--primary-color);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .stat-card h3 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin: 15px 0;
            font-weight: 700;
        }
        
        .stat-card p {
            color: var(--gray-color);
            font-weight: 600;
            font-size: 16px;
        }
        
        .search-bar {
            display: flex;
            margin-bottom: 25px;
            gap: 12px;
        }
        
        .search-bar input {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .search-bar input:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .search-bar button {
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            border-left: 5px solid var(--primary-color);
        }
        
        .card h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card h2 i {
            font-size: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(30, 60, 114, 0.1);
        }
        
        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 15px 18px;
            text-align: left;
            border-bottom: 1px solid #eaeaea;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .low-stock {
            color: var(--danger-color);
            font-weight: 700;
        }
        
        .action-btn {
            padding: 8px 14px;
            margin-right: 5px;
            font-size: 14px;
            width: auto;
        }
        
        .btn-danger {
            background: var(--danger-color);
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-edit {
            background: var(--warning-color);
        }
        
        .btn-edit:hover {
            background: #e67e22;
        }
        
        .sell-form {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .sell-input {
            flex: 1;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .low-stock-section {
            display: none;
            margin-top: 25px;
            padding: 20px;
            background: #fff8e1;
            border-radius: 10px;
            border-left: 5px solid var(--warning-color);
        }
        
        .low-stock-item {
            padding: 12px;
            margin: 8px 0;
            background: #fff;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .history-section {
            display: none;
            margin-top: 25px;
        }
        
        /* Billing System Styles */
        .mode-toggle {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 12px;
            border-radius: 50px;
            width: 450px;
            margin: 0 auto 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .mode-btn {
            padding: 14px 35px;
            border: none;
            background: transparent;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 50px;
            transition: all 0.3s;
            width: 50%;
        }
        
        .mode-btn.active {
            background: linear-gradient(135deg, var(--success-color) 0%, #27ae60 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(39, 174, 96, 0.3);
        }
        
        .bill-title {
            font-size: 32px;
            color: var(--dark-color);
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            padding-bottom: 15px;
            font-weight: 700;
        }
        
        .bill-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 5px;
            background: linear-gradient(90deg, #3498db, var(--success-color));
            border-radius: 3px;
        }
        
        .invoice-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .invoice-meta, .client-info {
            flex: 1;
        }
        
        .invoice-number {
            font-weight: bold;
            font-size: 18px;
            color: var(--dark-color);
        }
        
        .invoice-date {
            color: var(--gray-color);
        }
        
        .client-info input, .client-info select {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            width: 100%;
            margin-top: 8px;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }
        
        .client-info input:focus, .client-info select:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .client-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .component-name {
            font-weight: 700;
            color: var(--dark-color);
            text-align: center;
            background-color: #fff8dc;
        }
        
        .total-row {
            font-weight: bold;
            background: linear-gradient(135deg, #eaf6ff 0%, #d6eaf8 100%);
        }
        
        .total-value {
            font-size: 22px;
            color: var(--danger-color);
            font-weight: 800;
        }
        
        .billing-action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--success-color) 0%, #27ae60 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 20px rgba(39, 174, 96, 0.3);
        }
        
        .btn-print {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            box-shadow: 0 5px 20px rgba(52, 152, 219, 0.3);
        }
        
        .btn-clear {
            background: linear-gradient(135deg, var(--danger-color) 0%, #c0392b 100%);
            box-shadow: 0 5px 20px rgba(231, 76, 60, 0.3);
        }
        
        .btn-history {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            box-shadow: 0 5px 20px rgba(155, 89, 182, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            color: var(--dark-color);
            font-size: 15px;
            width: 100%;
            padding: 25px;
            background: #f8f9fa;
            border-top: 1px solid #eaeaea;
        }
        
        /* Login Form */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .login-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            width: 400px;
            text-align: center;
            animation: scaleIn 0.5s ease;
        }
        
        @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .login-form h2 {
            margin-bottom: 20px;
            color: var(--dark-color);
            font-size: 28px;
        }
        
        .login-form p {
            margin-bottom: 25px;
            color: var(--gray-color);
        }
        
        .login-form input {
            width: 100%;
            padding: 15px;
            margin: 12px 0;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .login-form input:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .login-form button {
            width: 100%;
            padding: 15px;
            background: var(--success-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s;
        }
        
        .login-form button:hover {
            background: #27ae60;
        }
        
        .login-form .error {
            color: var(--danger-color);
            margin-top: 15px;
            display: none;
            font-weight: 600;
        }
        
        /* WhatsApp-style notification */
        .whatsapp-notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 350px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.25);
            z-index: 1000;
            overflow: hidden;
            display: none;
            animation: slideIn 0.4s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .whatsapp-header {
            background: #25D366;
            color: white;
            padding: 18px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
        }
        
        .whatsapp-header i {
            font-size: 22px;
        }
        
        .whatsapp-body {
            padding: 20px;
            color: #555;
            line-height: 1.5;
        }
        
        .whatsapp-body p {
            margin-bottom: 12px;
        }
        
        .whatsapp-footer {
            padding: 15px 20px;
            text-align: right;
            border-top: 1px solid #eee;
        }
        
        .whatsapp-footer button {
            width: auto;
            padding: 10px 20px;
            background: #25D366;
            border-radius: 6px;
        }
        
        /* Caution Modal */
        .caution-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }
        
        .caution-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 550px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            animation: scaleIn 0.5s ease;
        }
        
        .caution-icon {
            font-size: 60px;
            color: var(--warning-color);
            margin-bottom: 25px;
        }
        
        .caution-content h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 28px;
        }
        
        .caution-content p {
            margin-bottom: 25px;
            line-height: 1.6;
            color: var(--gray-color);
        }
        
        .caution-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .caution-btn:hover {
            background: var(--secondary-color);
        }
        
        /* History Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow: auto;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 1100px;
            max-height: 85vh;
            overflow-y: auto;
            animation: scaleIn 0.5s ease;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close:hover {
            color: var(--dark-color);
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .history-table th {
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            padding: 16px;
            text-align: left;
            color: white;
        }
        
        .history-table td {
            padding: 16px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .history-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .history-actions {
            display: flex;
            gap: 12px;
        }
        
        .history-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-view {
            background-color: #3498db;
            color: white;
        }
        
        .btn-view:hover {
            background-color: #2980b9;
        }
        
        .btn-delete {
            background-color: var(--danger-color);
            color: white;
        }
        
        .btn-delete:hover {
            background-color: #c0392b;
        }
        
        .empty-history {
            text-align: center;
            padding: 30px;
            color: var(--gray-color);
            font-style: italic;
            font-size: 18px;
        }
        
        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }
            
            #billing-system, #billing-system * {
                visibility: visible;
            }
            
            #billing-system {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .billing-action-buttons, .mode-toggle, .tabs, .header, .footer {
                display: none !important;
            }
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .client-details {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 20px 15px;
            }
            
            .logo-container {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-3d {
                margin-right: 0;
                margin-bottom: 10px;
            }
            
            .contact-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .logout-btn {
                position: relative;
                top: 0;
                right: 0;
                margin-top: 15px;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                width: 100%;
                justify-content: center;
                padding: 15px;
            }
            
            .content-area {
                padding: 20px 15px;
            }
            
            .search-bar {
                flex-direction: column;
            }
            
            .invoice-details {
                flex-direction: column;
                gap: 20px;
            }
            
            .billing-action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .mode-toggle {
                width: 100%;
                max-width: 320px;
            }
            
            .mode-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
            
            .history-actions {
                flex-direction: column;
            }
            
            .login-form {
                width: 90%;
                padding: 30px;
            }
            
            .whatsapp-notification {
                width: 90%;
                right: 5%;
                left: 5%;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
        
        /* Pulse Animation */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 900;
            transition: all 0.3s;
        }
        
        .fab:hover {
            transform: translateY(-5px) rotate(90deg);
            background: var(--secondary-color);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }
        
        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .quick-action-btn {
            background: white;
            border: 2px solid #e0e0e0;
            color: var(--dark-color);
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .quick-action-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Login Form -->
    <div class="login-container" id="login-container">
        <div class="login-form">
            <h2><i class="fas fa-lock"></i> A2Z Lankans</h2>
            <p>Please enter password to access the system</p>
            <input type="password" id="password-input" placeholder="Enter password">
            <button id="login-btn"><i class="fas fa-sign-in-alt"></i> Login</button>
            <div class="error" id="login-error">Incorrect password. Please try again.</div>
        </div>
    </div>
    
    <!-- Canvas for background animation -->
    <canvas id="canvas-background"></canvas>
    
    <!-- Caution Modal -->
    <div class="caution-modal" id="caution-modal">
        <div class="caution-content">
            <div class="caution-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h2>Data Management Caution</h2>
            <p>Please be careful when adding data to the system. All information entered will be stored in your browser's local storage and will persist between sessions.</p>
            <p>Ensure you only add accurate and necessary data to maintain system integrity.</p>
            <button class="caution-btn" onclick="closeCautionModal()">I Understand</button>
        </div>
    </div>

    <div class="main-container" id="main-container" style="display: none;">
        <div class="header">
            <div class="logo-container">
                <div class="logo-3d">A2Z</div>
                <div class="logo-text">LANKANS COMPUTER SHOP</div>
            </div>
            <div class="contact-info">
                <p><i class="fas fa-phone"></i> 077 872 5707</p>
                <p><i class="fas fa-map-marker-alt"></i> Main street, Buhary Junction, Kinniya, Trincomalee</p>
                <p><i class="fas fa-envelope"></i> AZZLANKANS@GMAIL.COM</p>
            </div>
            <button class="logout-btn" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
        
        <div class="tabs">
            <button class="tab active" data-tab="stock-management">
                <i class="fas fa-boxes"></i> Stock Management
            </button>
            <button class="tab" data-tab="billing-system">
                <i class="fas fa-receipt"></i> Billing System
            </button>
            <button class="tab" data-tab="reports">
                <i class="fas fa-chart-line"></i> Reports
            </button>
            <button class="tab" data-tab="settings">
                <i class="fas fa-cog"></i> Settings
            </button>
        </div>
        
        <!-- Stock Management Content -->
        <div id="stock-management" class="content-area active">
            <div class="stats">
                <div class="stat-card">
                    <p><i class="fas fa-box"></i> Total Products</p>
                    <h3 id="total-products">0</h3>
                </div>
                <div class="stat-card">
                    <p><i class="fas fa-money-bill-wave"></i> Total Stock Value</p>
                    <h3 id="total-value">₹0</h3>
                </div>
                <div class="stat-card">
                    <p><i class="fas fa-exclamation-triangle"></i> Low Stock Items</p>
                    <h3 id="low-stock-count">0</h3>
                </div>
                <div class="stat-card">
                    <p><i class="fas fa-chart-bar"></i> Total Categories</p>
                    <h3 id="total-categories">0</h3>
                </div>
            </div>
            
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="showAddProductForm()">
                    <i class="fas fa-plus"></i> Add Product
                </button>
                <button class="quick-action-btn" onclick="showLowStock()">
                    <i class="fas fa-exclamation-circle"></i> Show Low Stock
                </button>
                <button class="quick-action-btn" onclick="showHistory()">
                    <i class="fas fa-history"></i> Show History
                </button>
                <button class="quick-action-btn" onclick="exportData()">
                    <i class="fas fa-download"></i> Export Data
                </button>
            </div>
            
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search computer products..." onkeyup="if(event.key==='Enter') searchProducts()">
                <button onclick="searchProducts()"><i class="fas fa-search"></i> Search</button>
                <button onclick="clearSearch()"><i class="fas fa-times"></i> Clear</button>
            </div>
            
            <div class="card">
                <h2><i class="fas fa-list"></i> Computer Products List</h2>
                <div class="table-container">
                    <table id="products-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Value</th>
                                <th>Added Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Products will be dynamically inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div id="add-product-section" class="card" style="display: none;">
                <h2><i class="fas fa-plus-circle"></i> Add New Computer Product</h2>
                <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="product-name">Product Name</label>
                        <input type="text" id="product-name" placeholder="e.g., Gaming Keyboard">
                    </div>
                    <div class="form-group">
                        <label for="product-category">Category</label>
                        <select id="product-category">
                            <option value="Motherboard">Motherboard</option>
                            <option value="Processor">Processor</option>
                            <option value="Memory(RAM)">Memory(RAM)</option>
                            <option value="Storage">Storage</option>
                            <option value="Power Supply">Power Supply</option>
                            <option value="Graphics Card">Graphics Card</option>
                            <option value="Casing">Casing</option>
                            <option value="CPU Cooler">CPU Cooler</option>
                            <option value="Optical Drive">Optical Drive</option>
                            <option value="Accessories">Accessories</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="form-row" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="form-group">
                        <label for="product-price">Price (₹)</label>
                        <input type="number" id="product-price" placeholder="e.g., 4500">
                    </div>
                    <div class="form-group">
                        <label for="product-quantity">Quantity</label>
                        <input type="number" id="product-quantity" placeholder="e.g., 10">
                    </div>
                </div>
                <div class="form-group">
                    <label for="product-description">Description (Optional)</label>
                    <textarea id="product-description" placeholder="Product details..." style="width: 100%; padding: 14px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px; min-height: 100px;"></textarea>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button onclick="addProduct()"><i class="fas fa-save"></i> Save Product</button>
                    <button onclick="hideAddProductForm()" style="background: var(--gray-color);"><i class="fas fa-times"></i> Cancel</button>
                </div>
            </div>
            
            <div id="low-stock-section" class="low-stock-section">
                <h3><i class="fas fa-exclamation-triangle"></i> Low Stock Items - Need Restocking</h3>
                <div id="low-stock-items">
                    <!-- Low stock items will be displayed here -->
                </div>
            </div>
            
            <div id="history-section" class="history-section">
                <div class="card">
                    <h2><i class="fas fa-history"></i> Transaction History</h2>
                    <div class="table-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Product</th>
                                    <th>Type</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th>Total</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- History will be dynamically inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Billing System Content -->
        <div id="billing-system" class="content-area">
            <div class="mode-toggle">
                <button class="mode-btn active" id="bill-mode">Billing Mode</button>
                <button class="mode-btn" id="quote-mode">Quotation Mode</button>
            </div>
            
            <h2 class="bill-title" id="document-title">COMPUTER PARTS BILLING SYSTEM</h2>
            
            <div class="invoice-details">
                <div class="invoice-meta">
                    <p class="invoice-number" id="doc-number">Invoice Number: <input type="text" id="invoice-number" value="1"></p>
                    <p class="invoice-date">Date: <input type="text" id="invoice-date" value="8/21/2025"></p>
                    <p class="validity print-only" id="validity-text">Valid Until: <span id="valid-until"></span></p>
                </div>
                <div class="client-info">
                    <p><strong id="client-label">Bill To:</strong> 
                        <input type="text" id="client-name" placeholder="Client Name">
                    </p>
                    
                    <div class="client-details">
                        <div>
                            <strong>Phone Number:</strong>
                            <input type="text" id="client-phone" placeholder="Client Phone Number">
                        </div>
                        <div>
                            <strong>Address:</strong>
                            <input type="text" id="client-address" placeholder="Client Address">
                        </div>
                    </div>
                    
                    <p style="margin-top: 10px;">
                        <strong>Client Type:</strong>
                        <select id="client-type">
                            <option value="retail">Retail Customer</option>
                            <option value="business">Business Customer</option>
                            <option value="government">Government Organization</option>
                            <option value="educational">Educational Institution</option>
                        </select>
                    </p>
                </div>
            </div>
            
            <table id="bill-table">
                <thead>
                    <tr>
                        <th width="5%">NO</th>
                        <th width="25%">Component</th>
                        <th width="35%">Details</th>
                        <th width="17.5%">Price (LKR)</th>
                        <th width="17.5%">Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>01</td>
                        <td class="component-name">PROCESSOR</td>
                        <td><input type="text" class="details-input" placeholder="Enter processor details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>02</td>
                        <td class="component-name">MOTHERBOARD</td>
                        <td><input type="text" class="details-input" placeholder="Enter motherboard details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>03</td>
                        <td class="component-name">RAM</td>
                        <td><input type="text" class="details-input" placeholder="Enter RAM details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>04</td>
                        <td class="component-name">CPU COOLER</td>
                        <td><input type="text" class="details-input" placeholder="Enter cooler details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>05</td>
                        <td class="component-name">SSD/M.2/NVME</td>
                        <td><input type="text" class="details-input" placeholder="Enter storage details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>06</td>
                        <td class="component-name">HDD</td>
                        <td><input type="text" class="details-input" placeholder="Enter HDD details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>07</td>
                        <td class="component-name">VGA</td>
                        <td><input type="text" class="details-input" placeholder="Enter graphics card details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>08</td>
                        <td class="component-name">CASING</td>
                        <td><input type="text" class="details-input" placeholder="Enter case details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>09</td>
                        <td class="component-name">POWER SUPPLY</td>
                        <td><input type="text" class="details-input" placeholder="Enter PSU details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td class="component-name">RGB FANS</td>
                        <td><input type="text" class="details-input" placeholder="Enter fan details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td class="component-name">MONITOR</td>
                        <td><input type="text" class="details-input" placeholder="Enter monitor details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td class="component-name">KEYBOARD</td>
                        <td><input type="text" class="details-input" placeholder="Enter keyboard details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td class="component-name">MOUSE</td>
                        <td><input type="text" class="details-input" placeholder="Enter mouse details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>14</td>
                        <td class="component-name">COMBO (KB+Mouse)</td>
                        <td><input type="text" class="details-input" placeholder="Enter combo details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td class="component-name">SPEAKER</td>
                        <td><input type="text" class="details-input" placeholder="Enter speaker details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>16</td>
                        <td class="component-name">POWER CABLE</td>
                        <td><input type="text" class="details-input" placeholder="Enter cable details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr>
                        <td>17</td>
                        <td class="component-name">VIDEO CABLES</td>
                        <td><input type="text" class="details-input" placeholder="Enter cable details"></td>
                        <td><input type="number" class="price-input" placeholder="Enter price"></td>
                        <td><input type="number" class="qty-input" value="0" min="0"></td>
                    </tr>
                    <tr class="total-row">
                        <td colspan="3" style="text-align: right;"><strong>TOTAL (LKR)</strong></td>
                        <td class="total-value" id="total-amount">0.00</td>
                        <td id="total-qty">0</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="billing-action-buttons">
                <button class="btn btn-calculate" id="calculate-btn">
                    <i class="fas fa-calculator"></i> Calculate Total
                </button>
                <button class="btn btn-print" id="print-btn">
                    <i class="fas fa-print"></i> Print Document
                </button>
                <button class="btn btn-clear" id="clear-btn">
                    <i class="fas fa-trash"></i> Clear All
                </button>
                <button class="btn btn-history" id="history-btn">
                    <i class="fas fa-history"></i> History
                </button>
                <button class="btn" id="save-btn">
                    <i class="fas fa-save"></i> Save Bill
                </button>
            </div>
        </div>
        
        <!-- Reports Content -->
        <div id="reports" class="content-area">
            <div class="card">
                <h2><i class="fas fa-chart-pie"></i> Sales Reports</h2>
                <p>Reports functionality will be implemented in the next version.</p>
            </div>
        </div>
        
        <!-- Settings Content -->
        <div id="settings" class="content-area">
            <div class="card">
                <h2><i class="fas fa-cog"></i> System Settings</h2>
                <p>Settings functionality will be implemented in the next version.</p>
            </div>
        </div>
        
        <div class="footer">
            <p>Thank you for your business with us. We hope to see you soon again.</p>
            <p>AZZLANKANS@GMAIL.COM | PH: 0757584842 | WhatsApp: 0778725707</p>
            <p>A2Z Lankans Computer Shop Management System © 2023</p>
        </div>
    </div>

    <!-- WhatsApp-style notification -->
    <div class="whatsapp-notification" id="whatsapp-notification">
        <div class="whatsapp-header">
            <i class="fab fa-whatsapp"></i>
            <span>System Notification</span>
        </div>
        <div class="whatsapp-body">
            <p id="alert-message"></p>
        </div>
        <div class="whatsapp-footer">
            <button onclick="closeNotification()">OK</button>
        </div>
    </div>

    <!-- History Modal -->
    <div id="history-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Billing History</h2>
            <div id="history-content">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Document No</th>
                            <th>Client</th>
                            <th>Type</th>
                            <th>Total (LKR)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="history-table-body">
                        <!-- History data will be inserted here -->
                    </tbody>
                </table>
                <div id="empty-history" class="empty-history">
                    No billing history found. Your saved bills and quotations will appear here.
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="fab" id="fab" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // Enhanced JavaScript code with additional features
        // This is a simplified version - full implementation would require more code
        
        // Tab navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const tabs = document.querySelectorAll('.tab');
            const contentAreas = document.querySelectorAll('.content-area');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const target = this.getAttribute('data-tab');
                    
                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show target content area
                    contentAreas.forEach(area => {
                        area.classList.remove('active');
                        if (area.id === target) {
                            area.classList.add('active');
                        }
                    });
                });
            });
            
            // Initialize login functionality
            initLogin();
            
            // Set current date
            const currentDate = new Date();
            const formattedDate = `${currentDate.getDate().toString().padStart(2, '0')}/${(currentDate.getMonth()+1).toString().padStart(2, '0')}/${currentDate.getFullYear()}`;
            document.getElementById('invoice-date').value = formattedDate;
            
            // Set validity date for quotation (7 days from now)
            const validityDate = new Date();
            validityDate.setDate(validityDate.getDate() + 7);
            const formattedValidityDate = `${validityDate.getDate().toString().padStart(2, '0')}/${(validityDate.getMonth()+1).toString().padStart(2, '0')}/${validityDate.getFullYear()}`;
            document.getElementById('valid-until').textContent = formattedValidityDate;
        });
        
        // Login functionality
        function initLogin() {
            const loginContainer = document.getElementById('login-container');
            const mainContainer = document.getElementById('main-container');
            const passwordInput = document.getElementById('password-input');
            const loginBtn = document.getElementById('login-btn');
            const loginError = document.getElementById('login-error');
            const logoutBtn = document.getElementById('logout-btn');
            
            // Focus on password input when page loads
            passwordInput.focus();
            
            // Login button click event
            loginBtn.addEventListener('click', function() {
                if (passwordInput.value === 'admin123') {
                    // Correct password
                    loginContainer.style.display = 'none';
                    mainContainer.style.display = 'block';
                    // Initialize the apps
                    initStockManagement();
                    initBillingSystem();
                } else {
                    // Incorrect password
                    loginError.style.display = 'block';
                    passwordInput.value = '';
                    passwordInput.focus();
                }
            });
            
            // Logout button click event
            logoutBtn.addEventListener('click', function() {
                mainContainer.style.display = 'none';
                loginContainer.style.display = 'flex';
                passwordInput.value = '';
                passwordInput.focus();
            });
            
            // Allow login on Enter key press
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loginBtn.click();
                }
            });
        }
        
        // ========== STOCK MANAGEMENT FUNCTIONS ==========
        function initStockManagement() {
            // Initialize products and history from localStorage or empty arrays
            window.products = JSON.parse(localStorage.getItem('products')) || [];
            window.historyTransactions = JSON.parse(localStorage.getItem('historyTransactions')) || [];
            
            // Update table and stats
            updateProductsTable();
            updateStats();
        }
        
        // Function to save data to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('products', JSON.stringify(products));
            localStorage.setItem('historyTransactions', JSON.stringify(historyTransactions));
        }
        
        // Function to close caution modal
        function closeCautionModal() {
            document.getElementById('caution-modal').style.display = 'none';
        }
        
        // Function to show WhatsApp-style notification
        function showWhatsAppNotification(message) {
            const notification = document.getElementById('whatsapp-notification');
            const alertMessage = document.getElementById('alert-message');
            
            alertMessage.textContent = message;
            notification.style.display = 'block';
            
            // Auto close after 5 seconds
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }
        
        // Function to close notification
        function closeNotification() {
            document.getElementById('whatsapp-notification').style.display = 'none';
        }
        
        // Function to show add product form
        function showAddProductForm() {
            document.getElementById('add-product-section').style.display = 'block';
            document.getElementById('low-stock-section').style.display = 'none';
            document.getElementById('history-section').style.display = 'none';
            document.getElementById('product-name').focus();
        }
        
        // Function to hide add product form
        function hideAddProductForm() {
            document.getElementById('add-product-section').style.display = 'none';
            // Clear form
            document.getElementById('product-name').value = '';
            document.getElementById('product-price').value = '';
            document.getElementById('product-quantity').value = '';
            document.getElementById('product-description').value = '';
        }
        
        // Function to show low stock items
        function showLowStock() {
            const lowStockSection = document.getElementById('low-stock-section');
            const lowStockItems = document.getElementById('low-stock-items');
            
            const lowStockProducts = products.filter(product => product.quantity < 5);
            
            if (lowStockProducts.length === 0) {
                lowStockItems.innerHTML = '<p>No low stock items at the moment.</p>';
            } else {
                lowStockItems.innerHTML = '';
                lowStockProducts.forEach(product => {
                    const item = document.createElement('div');
                    item.className = 'low-stock-item';
                    item.innerHTML = `
                        <div>
                            <strong>${product.name}</strong> (${product.category})
                        </div>
                        <div class="low-stock">
                            Only ${product.quantity} left in stock
                        </div>
                    `;
                    lowStockItems.appendChild(item);
                });
            }
            
            lowStockSection.style.display = 'block';
            document.getElementById('add-product-section').style.display = 'none';
            document.getElementById('history-section').style.display = 'none';
        }
        
        // Function to show history
        function showHistory() {
            document.getElementById('history-section').style.display = 'block';
            document.getElementById('add-product-section').style.display = 'none';
            document.getElementById('low-stock-section').style.display = 'none';
            renderHistoryTable();
        }
        
        // Function to export data
        function exportData() {
            // This would typically export data to CSV or Excel
            showWhatsAppNotification('Data export feature will be available in the next update.');
        }
        
        // Function to scroll to top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Function to add a new product
        function addProduct() {
            const name = document.getElementById('product-name').value;
            const price = document.getElementById('product-price').value;
            const quantity = document.getElementById('product-quantity').value;
            const category = document.getElementById('product-category').value;
            const description = document.getElementById('product-description').value;
            
            if (name && price && quantity) {
                // Check if product already exists
                const existingProductIndex = products.findIndex(p => p.name.toLowerCase() === name.toLowerCase());
                
                if (existingProductIndex !== -1) {
                    // Product exists, increase quantity
                    products[existingProductIndex].quantity += parseInt(quantity);
                    
                    // Save to localStorage
                    saveToLocalStorage();
                    
                    showWhatsAppNotification(`Increased stock of "${name}" by ${quantity} units!`);
                    
                    // Add to history
                    historyTransactions.unshift({
                        date: new Date().toISOString().split('T')[0],
                        product: name,
                        type: 'Stock Added',
                        quantity: parseInt(quantity),
                        price: parseFloat(price),
                        total: parseFloat(price) * parseInt(quantity)
                    });
                    
                    // Save history to localStorage
                    saveToLocalStorage();
                } else {
                    // Get current date
                    const currentDate = new Date();
                    const dateString = currentDate.toISOString().split('T')[0];
                    
                    // Create new product
                    const newProduct = {
                        id: Date.now(), // Use timestamp for unique ID
                        name,
                        price: parseFloat(price),
                        quantity: parseInt(quantity),
                        category,
                        description,
                        date: dateString
                    };
                    
                    // Add to products array
                    products.push(newProduct);
                    
                    // Save to localStorage
                    saveToLocalStorage();
                    
                    showWhatsAppNotification(`"${name}" added successfully on ${dateString}!`);
                    
                    // Add to history
                    historyTransactions.unshift({
                        date: dateString,
                        product: name,
                        type: 'Stock Added',
                        quantity: parseInt(quantity),
                        price: parseFloat(price),
                        total: parseFloat(price) * parseInt(quantity)
                    });
                    
                    // Save history to localStorage
                    saveToLocalStorage();
                }
                
                // Update table and stats
                updateProductsTable();
                
                // Hide the form
                hideAddProductForm();
                
            } else {
                showWhatsAppNotification('Please fill in all required details!');
            }
        }
        
        // Function to sell a product
        function sellProduct(id) {
            const quantityInput = document.getElementById(`qty-${id}`);
            const quantityToSell = parseInt(quantityInput.value);
            
            if (quantityToSell > 0) {
                const productIndex = products.findIndex(p => p.id === id);
                
                if (productIndex !== -1) {
                    if (products[productIndex].quantity >= quantityToSell) {
                        products[productIndex].quantity -= quantityToSell;
                        
                        // Save to localStorage
                        saveToLocalStorage();
                        
                        // Add to history
                        historyTransactions.unshift({
                            date: new Date().toISOString().split('T')[0],
                            product: products[productIndex].name,
                            type: 'Sale',
                            quantity: quantityToSell,
                            price: products[productIndex].price,
                            total: products[productIndex].price * quantityToSell
                        });
                        
                        // Save history to localStorage
                        saveToLocalStorage();
                        
                        updateProductsTable();
                        
                        // Check if stock is now low after selling
                        if (products[productIndex].quantity < 5) {
                            showWhatsAppNotification(`Low stock alert! Only ${products[productIndex].quantity} "${products[productIndex].name}" left in stock.`);
                        } else {
                            showWhatsAppNotification(`Sale recorded successfully! Sold ${quantityToSell} of ${products[productIndex].name}`);
                        }
                    } else {
                        showWhatsAppNotification('Not enough stock available!');
                    }
                }
                
                quantityInput.value = '';
            } else {
                showWhatsAppNotification('Please enter a valid quantity!');
            }
        }
        
        // Function to delete a product
        function deleteProduct(id) {
            const productIndex = products.findIndex(p => p.id === id);
            
            if (productIndex !== -1) {
                const productName = products[productIndex].name;
                if (confirm(`Are you sure you want to delete ${productName}?`)) {
                    products.splice(productIndex, 1);
                    
                    // Save to localStorage
                    saveToLocalStorage();
                    
                    updateProductsTable();
                    showWhatsAppNotification(`"${productName}" has been deleted successfully!`);
                }
            }
        }
        
        // Function to delete a history entry
        function deleteHistory(index) {
            if (index >= 0 && index < historyTransactions.length) {
                const transaction = historyTransactions[index];
                if (confirm(`Are you sure you want to delete this transaction?`)) {
                    historyTransactions.splice(index, 1);
                    
                    // Save to localStorage
                    saveToLocalStorage();
                    
                    renderHistoryTable();
                    showWhatsAppNotification(`Transaction has been deleted successfully!`);
                }
            }
        }
        
        // Function to search products
        function searchProducts() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            if (searchTerm) {
                const filteredProducts = products.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) || 
                    product.category.toLowerCase().includes(searchTerm)
                );
                
                // Update table with filtered products
                renderProductsTable(filteredProducts);
            } else {
                // Show all products if search is empty
                updateProductsTable();
            }
        }
        
        // Function to clear search
        function clearSearch() {
            document.getElementById('search-input').value = '';
            updateProductsTable();
        }
        
        // Function to render products table
        function renderProductsTable(productsArray) {
            const tableBody = document.querySelector('#products-table tbody');
            tableBody.innerHTML = '';
            
            if (productsArray.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 30px; color: var(--gray-color);">
                            <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px; display: block;"></i>
                            <p>No products found. Add some products to get started.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            productsArray.forEach(product => {
                const row = document.createElement('tr');
                
                // Add product cells
                row.innerHTML = `
                    <td>${product.name}</td>
                    <td>${product.category}</td>
                    <td>₹${product.price.toLocaleString()}</td>
                    <td class="${product.quantity < 5 ? 'low-stock' : ''}">${product.quantity}</td>
                    <td>₹${(product.price * product.quantity).toLocaleString()}</td>
                    <td>${product.date}</td>
                    <td>
                        <div class="action-buttons">
                            <div class="sell-form">
                                <input type="number" class="sell-input" placeholder="Qty" min="1" id="qty-${product.id}">
                                <button class="action-btn" onclick="sellProduct(${product.id})">Sell</button>
                            </div>
                            <button class="action-btn btn-edit" onclick="editProduct(${product.id})"><i class="fas fa-edit"></i></button>
                            <button class="action-btn btn-danger" onclick="deleteProduct(${product.id})"><i class="fas fa-trash"></i></button>
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Function to update products table
        function updateProductsTable() {
            renderProductsTable(products);
            updateStats();
        }
        
        // Function to update statistics
        function updateStats() {
            const totalProducts = products.length;
            const totalValue = products.reduce((sum, product) => sum + (product.price * product.quantity), 0);
            const lowStockCount = products.filter(product => product.quantity < 5).length;
            const categories = [...new Set(products.map(product => product.category))].length;
            
            document.getElementById('total-products').textContent = totalProducts;
            document.getElementById('total-value').textContent = `₹${totalValue.toLocaleString()}`;
            document.getElementById('low-stock-count').textContent = lowStockCount;
            document.getElementById('total-categories').textContent = categories;
            
            // Show notification if there are low stock items
            if (lowStockCount > 0) {
                const lowStockItems = products.filter(product => product.quantity < 5);
                let message = `You have ${lowStockCount} low stock item${lowStockCount > 1 ? 's' : ''} that need attention.`;
                
                showWhatsAppNotification(message);
            }
        }
        
        // Function to render history table
        function renderHistoryTable() {
            const historyTableBody = document.querySelector('.history-table tbody');
            historyTableBody.innerHTML = '';
            
            if (historyTransactions.length === 0) {
                historyTableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 30px; color: var(--gray-color);">
                            <i class="fas fa-history" style="font-size: 48px; margin-bottom: 15px; display: block;"></i>
                            <p>No transaction history yet.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            historyTransactions.forEach((transaction, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${transaction.date}</td>
                    <td>${transaction.product}</td>
                    <td>${transaction.type}</td>
                    <td>${transaction.quantity}</td>
                    <td>₹${transaction.price.toLocaleString()}</td>
                    <td>₹${transaction.total.toLocaleString()}</td>
                    <td>
                        <button class="action-btn btn-danger" onclick="deleteHistory(${index})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                historyTableBody.appendChild(row);
            });
        }
        
        // ========== BILLING SYSTEM FUNCTIONS ==========
        function initBillingSystem() {
            // Canvas Animation
            (function() {
                const canvas = document.getElementById('canvas-background');
                const ctx = canvas.getContext('2d');
                
                // Set canvas size to window size
                function resizeCanvas() {
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight;
                }
                
                window.addEventListener('resize', resizeCanvas);
                resizeCanvas();
                
                // Mouse position
                let mouseX = 0;
                let mouseY = 0;
                
                canvas.addEventListener('mousemove', (e) => {
                    mouseX = e.clientX;
                    mouseY = e.clientY;
                });
                
                // Particle class
                class Particle {
                    constructor() {
                        this.x = Math.random() * canvas.width;
                        this.y = Math.random() * canvas.height;
                        this.size = Math.random() * 5 + 1;
                        this.speedX = Math.random() * 3 - 1.5;
                        this.speedY = Math.random() * 3 - 1.5;
                        this.color = `hsl(${Math.random() * 360}, 50%, 50%)`;
                    }
                    
                    update() {
                        this.x += this.speedX;
                        this.y += this.speedY;
                        
                        // Bounce off the walls
                        if (this.x > canvas.width || this.x < 0) {
                            this.speedX = -this.speedX;
                        }
                        if (this.y > canvas.height || this.y < 0) {
                            this.speedY = -this.speedY;
                        }
                        
                        // Interact with mouse
                        const dx = mouseX - this.x;
                        const dy = mouseY - this.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < 100) {
                            this.speedX += dx * 0.01;
                            this.speedY += dy * 0.01;
                        }
                    }
                    
                    draw() {
                        ctx.fillStyle = this.color;
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
                
                // Create particles
                const particles = [];
                for (let i = 0; i < 100; i++) {
                    particles.push(new Particle());
                }
                
                // Animation loop
                function animate() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    
                    // Create gradient background
                    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                    gradient.addColorStop(0, '#1a2a6c');
                    gradient.addColorStop(0.5, '#b21f1f');
                    gradient.addColorStop(1, '#fdbb2d');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Update and draw particles
                    for (let i = 0; i < particles.length; i++) {
                        particles[i].update();
                        particles[i].draw();
                        
                        // Draw lines between nearby particles
                        for (let j = i; j < particles.length; j++) {
                            const dx = particles[i].x - particles[j].x;
                            const dy = particles[i].y - particles[j].y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            
                            if (distance < 100) {
                                ctx.beginPath();
                                ctx.strokeStyle = `rgba(255, 255, 255, ${1 - distance/100})`;
                                ctx.lineWidth = 0.5;
                                ctx.moveTo(particles[i].x, particles[i].y);
                                ctx.lineTo(particles[j].x, particles[j].y);
                                ctx.stroke();
                            }
                        }
                    }
                    
                    requestAnimationFrame(animate);
                }
                
                animate();
            })();

            // Calculate total button
            const calculateBtn = document.getElementById('calculate-btn');
            calculateBtn.addEventListener('click', function() {
                let total = 0;
                let totalQty = 0;
                
                document.querySelectorAll('.price-input').forEach((input, index) => {
                    const qtyInputs = document.querySelectorAll('.qty-input');
                    const qty = qtyInputs[index].value ? parseInt(qtyInputs[index].value) : 0;
                    const price = input.value ? parseFloat(input.value) : 0;
                    
                    if (input.value) {
                        total += price * qty;
                        totalQty += qty;
                    }
                });
                
                const totalElement = document.getElementById('total-amount');
                const totalQtyElement = document.getElementById('total-qty');
                
                // Format the total with thousand separators
                totalElement.textContent = total.toLocaleString('en-US', {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
                
                totalQtyElement.textContent = totalQty;
                
                // Add pulse animation
                totalElement.classList.add('pulse');
                totalQtyElement.classList.add('pulse');
                setTimeout(() => {
                    totalElement.classList.remove('pulse');
                    totalQtyElement.classList.remove('pulse');
                }, 500);
            });
            
            // Clear all button
            const clearBtn = document.getElementById('clear-btn');
            clearBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all fields?')) {
                    document.querySelectorAll('input').forEach(input => {
                        if (input.id !== 'invoice-number' && input.id !== 'invoice-date') {
                            input.value = '';
                        }
                    });
                    
                    document.querySelectorAll('.qty-input').forEach(input => {
                        input.value = '0';
                    });
                    
                    document.getElementById('total-amount').textContent = '0.00';
                    document.getElementById('total-qty').textContent = '0';
                    
                    // Reset client details
                    document.getElementById('client-name').value = '';
                    document.getElementById('client-phone').value = '';
                    document.getElementById('client-address').value = '';
                    
                    // Set focus to first input
                    document.querySelector('.details-input').focus();
                }
            });
            
            // Print button with row hiding functionality
            const printBtn = document.getElementById('print-btn');
            printBtn.addEventListener('click', function() {
                // First mark empty rows for hiding in print
                document.querySelectorAll('tbody tr').forEach(row => {
                    if (!row.classList.contains('total-row')) {
                        const detailsInput = row.querySelector('.details-input');
                        const priceInput = row.querySelector('.price-input');
                        
                        if (!detailsInput.value && !priceInput.value) {
                            row.classList.add('hidden-row');
                        } else {
                            row.classList.remove('hidden-row');
                        }
                    }
                });
                
                // Save to history before printing
                saveToHistory();
                
                // Now print
                window.print();
            });
            
            // Save bill button
            const saveBtn = document.getElementById('save-btn');
            saveBtn.addEventListener('click', function() {
                saveToHistory();
                showWhatsAppNotification('Bill saved successfully!');
            });
            
            // Mode toggle functionality
            const billModeBtn = document.getElementById('bill-mode');
            const quoteModeBtn = document.getElementById('quote-mode');
            const docTitle = document.getElementById('document-title');
            const docNumber = document.getElementById('doc-number');
            const clientLabel = document.getElementById('client-label');
            const validityText = document.getElementById('validity-text');
            
            billModeBtn.addEventListener('click', function() {
                billModeBtn.classList.add('active');
                quoteModeBtn.classList.remove('active');
                docTitle.textContent = 'COMPUTER PARTS BILLING SYSTEM';
                docNumber.innerHTML = 'Invoice Number: <input type="text" id="invoice-number" value="' + (parseInt(localStorage.getItem('lastInvoiceNumber') || 0) + 1) + '">';
                clientLabel.textContent = 'Bill To:';
                validityText.style.display = 'none';
            });
            
            quoteModeBtn.addEventListener('click', function() {
                quoteModeBtn.classList.add('active');
                billModeBtn.classList.remove('active');
                docTitle.textContent = 'COMPUTER PARTS QUOTATION SYSTEM';
                docNumber.innerHTML = 'Quotation Number: <input type="text" id="invoice-number" value="Q' + (parseInt(localStorage.getItem('lastQuotationNumber') || 0) + 1) + '">';
                clientLabel.textContent = 'Quotation For:';
                validityText.style.display = 'block';
            });
            
            // Auto-calculate when prices change
            document.querySelectorAll('.price-input, .qty-input').forEach(input => {
                input.addEventListener('input', function() {
                    calculateBtn.click();
                });
            });
            
            // History Modal functionality
            const historyModal = document.getElementById('history-modal');
            const historyBtn = document.getElementById('history-btn');
            const closeBtn = document.getElementsByClassName('close')[0];
            const historyTableBody = document.getElementById('history-table-body');
            const emptyHistory = document.getElementById('empty-history');
            
            // Open modal when history button is clicked
            historyBtn.addEventListener('click', function() {
                loadHistory();
                historyModal.style.display = 'block';
            });
            
            // Close modal when X is clicked
            closeBtn.addEventListener('click', function() {
                historyModal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target == historyModal) {
                    historyModal.style.display = 'none';
                }
            });
            
            // Initial calculation on page load
            calculateBtn.click();
        }
        
        // Function to save current bill/quote to history
        function saveToHistory() {
            // Get current mode
            const isQuoteMode = document.getElementById('quote-mode').classList.contains('active');
            const docNumber = document.getElementById('invoice-number').value;
            const date = document.getElementById('invoice-date').value;
            const clientName = document.getElementById('client-name').value;
            const clientPhone = document.getElementById('client-phone').value;
            const clientAddress = document.getElementById('client-address').value;
            const clientType = document.getElementById('client-type').value;
            const totalAmount = document.getElementById('total-amount').textContent;
            
            // Update last used number
            if (isQuoteMode) {
                const quoteNumber = parseInt(docNumber.replace('Q', '')) || 0;
                localStorage.setItem('lastQuotationNumber', quoteNumber);
            } else {
                const invoiceNumber = parseInt(docNumber) || 0;
                localStorage.setItem('lastInvoiceNumber', invoiceNumber);
            }
            
            // Collect all item data
            const items = [];
            document.querySelectorAll('tbody tr').forEach(row => {
                if (!row.classList.contains('total-row')) {
                    const component = row.querySelector('.component-name').textContent;
                    const details = row.querySelector('.details-input').value;
                    const price = row.querySelector('.price-input').value;
                    const quantity = row.querySelector('.qty-input').value;
                    
                    if (details || price) {
                        items.push({
                            component,
                            details,
                            price,
                            quantity
                        });
                    }
                }
            });
            
            // Create history object
            const historyItem = {
                id: Date.now(), // Unique ID based on timestamp
                type: isQuoteMode ? 'quotation' : 'invoice',
                docNumber,
                date,
                clientName,
                clientPhone,
                clientAddress,
                clientType,
                totalAmount,
                items
            };
            
            // Get existing history or initialize empty array
            let history = JSON.parse(localStorage.getItem('billingHistory') || '[]');
            
            // Add new item to history
            history.push(historyItem);
            
            // Save back to localStorage
            localStorage.setItem('billingHistory', JSON.stringify(history));
            
            // Increment document number for next use
            if (isQuoteMode) {
                const nextQuoteNumber = (parseInt(docNumber.replace('Q', '')) || 0) + 1;
                document.getElementById('invoice-number').value = 'Q' + nextQuoteNumber;
            } else {
                const nextInvoiceNumber = (parseInt(docNumber) || 0) + 1;
                document.getElementById('invoice-number').value = nextInvoiceNumber;
            }
        }
        
        // Function to load and display history
        function loadHistory() {
            // Get history from localStorage
            const history = JSON.parse(localStorage.getItem('billingHistory') || '[]');
            
            // Clear the table body
            const historyTableBody = document.getElementById('history-table-body');
            historyTableBody.innerHTML = '';
            
            // Check if history is empty
            if (history.length === 0) {
                document.getElementById('empty-history').style.display = 'block';
                return;
            }
            
            // Hide empty history message
            document.getElementById('empty-history').style.display = 'none';
            
            // Add each history item to the table
            history.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${item.date}</td>
                    <td>${item.docNumber}</td>
                    <td>${item.clientName || 'N/A'}</td>
                    <td>${item.type === 'invoice' ? 'Invoice' : 'Quotation'}</td>
                    <td>${item.totalAmount}</td>
                    <td class="history-actions">
                        <button class="history-btn btn-view" data-id="${item.id}">View</button>
                        <button class="history-btn btn-delete" data-id="${item.id}">Delete</button>
                    </td>
                `;
                
                historyTableBody.appendChild(row);
            });
            
            // Add event listeners to view and delete buttons
            document.querySelectorAll('.btn-view').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    viewHistoryItem(id);
                });
            });
            
            document.querySelectorAll('.btn-delete').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    deleteHistoryItem(id);
                });
            });
        }
        
        // Function to view a history item
        function viewHistoryItem(id) {
            // Get history from localStorage
            const history = JSON.parse(localStorage.getItem('billingHistory') || '[]');
            
            // Find the item with matching ID
            const item = history.find(i => i.id == id);
            
            if (!item) {
                alert('Item not found in history!');
                return;
            }
            
            // Set the mode
            if (item.type === 'quotation') {
                document.getElementById('quote-mode').click();
            } else {
                document.getElementById('bill-mode').click();
            }
            
            // Set document details
            document.getElementById('invoice-number').value = item.docNumber;
            document.getElementById('invoice-date').value = item.date;
            document.getElementById('client-name').value = item.clientName || '';
            document.getElementById('client-phone').value = item.clientPhone || '';
            document.getElementById('client-address').value = item.clientAddress || '';
            document.getElementById('client-type').value = item.clientType || 'retail';
            
            // Clear all item inputs first
            document.querySelectorAll('.details-input, .price-input, .qty-input').forEach(input => {
                input.value = '';
            });
            
            // Set quantity to 0 by default
            document.querySelectorAll('.qty-input').forEach(input => {
                input.value = '0';
            });
            
            // Fill in the items
            item.items.forEach((itemData, index) => {
                const rows = document.querySelectorAll('tbody tr');
                
                // Find the row with matching component name
                for (let i = 0; i < rows.length; i++) {
                    if (!rows[i].classList.contains('total-row')) {
                        const componentName = rows[i].querySelector('.component-name').textContent;
                        
                        if (componentName === itemData.component) {
                            rows[i].querySelector('.details-input').value = itemData.details;
                            rows[i].querySelector('.price-input').value = itemData.price;
                            rows[i].querySelector('.qty-input').value = itemData.quantity;
                            break;
                        }
                    }
                }
            });
            
            // Calculate total
            document.getElementById('calculate-btn').click();
            
            // Close the modal
            document.getElementById('history-modal').style.display = 'none';
            
            // Scroll to top
            window.scrollTo(0, 0);
        }
        
        // Function to delete a history item
        function deleteHistoryItem(id) {
            if (!confirm('Are you sure you want to delete this item from history?')) {
                return;
            }
            
            // Get history from localStorage
            let history = JSON.parse(localStorage.getItem('billingHistory') || '[]');
            
            // Filter out the item with matching ID
            history = history.filter(item => item.id != id);
            
            // Save back to localStorage
            localStorage.setItem('billingHistory', JSON.stringify(history));
            
            // Reload the history table
            loadHistory();
        }
        
        // Show FAB when scrolling down
        window.onscroll = function() {
            const fab = document.getElementById('fab');
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                fab.style.display = 'flex';
            } else {
                fab.style.display = 'none';
            }
        };
    </script>
</body>
</html>